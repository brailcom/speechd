#!/bin/bash
# coding: utf-8
# Orca symbols import
# Copyright (C) 2020 Samuel Thibault <samuel.thibault@ens-lyon.org>
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU Lesser General Public License as published by
# the Free Software Foundation; either version 2.1 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public License
# along with this program.  If not, see <https://www.gnu.org/licenses/>.

export TEXTDOMAINDIR=/usr/local/share/locale

for lang in $(cat orca.polist) base
do
	mkdir -p $lang
	(
		cat << EOF
# This file was automatically generated by make import-orca
# DO NOT MODIFY IT!
# See locale/README.md to know how to import dictionaries

# locale/$lang/orca.dic
# Copyright (C) 2004-2020 Free Software Foundation, Inc.
# This file is distributed under the same license as the orca package.

symbols:
EOF
		IFS=$'\t'
		( while read sym C_version
		do
			CTX=""
			case "$sym" in
				\#*) continue ;;
			esac
			case "$C_version" in
				'') echo ; continue ;;
			esac
			case "$C_version" in
				math\ symbol*)
					CTX="--context=math symbol"
					C_version=${C_version#math symbol }
					;;
			esac

			if ! grep "^$sym	" $lang/symbols.dic > /dev/null 2>&1
			then
				translation=`LANGUAGE="$lang" gettext -d orca $CTX "$C_version"`

				printf "%s\t%s\tnone\n" "$sym" "$translation"
			fi
		done ) < orca.sym
	) > $lang/orca.dic
done
